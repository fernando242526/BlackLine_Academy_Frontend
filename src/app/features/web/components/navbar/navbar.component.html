<nav class="fixed top-0 w-full z-50 transition-all duration-300"
    [ngClass]="{'bg-opacity-90 backdrop-blur-md shadow-glow': scrolled, 'bg-transparent': !scrolled}">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
            <!-- Logo y marca -->
            <div class="flex-shrink-0 flex items-center">
                <a routerLink="/" class="flex items-center" (click)="closeMenu()">
                    <span class="text-xl font-extrabold tracking-wider">
                        <span class="text-neon-violet">BLACK</span><span class="text-cyber-cyan">LINE</span>
                    </span>
                    <span class="ml-1 text-xs uppercase tracking-widest text-ghost-gray">ACADEMY</span>
                </a>
            </div>

            <!-- Menú de navegación (escritorio) -->
            <div class="hidden md:flex items-center space-x-6">
                <ng-container *ngFor="let item of menuItems">
                    <a [routerLink]="item.path" [routerLinkActiveOptions]="{exact: item.exact}"
                        routerLinkActive="text-cyber-cyan border-b-2 border-cyber-cyan"
                        class="text-sm font-medium py-2 hover:text-neon-violet transition-colors duration-200 relative nav-link">
                        {{ item.label }}
                    </a>
                </ng-container>

                <!-- Enlaces de autenticación -->
                <div class="ml-4 flex items-center">
                    <ng-container *ngIf="isAuthenticated(); else notAuthenticated">
                        <!-- Menú de usuario autenticado -->
                        <div class="relative group">
                            <button class="flex items-center text-sm font-medium text-ghost-gray hover:text-cyber-cyan">
                                <span class="mr-1">{{ currentUser()?.nombre }}</span>
                                <fa-icon [icon]="faUser" class="text-cyber-cyan"></fa-icon>
                            </button>
                            <div
                                class="absolute right-0 mt-2 w-48 bg-void-black border border-plasma-line rounded-md shadow-glow opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 py-1">
                                <a routerLink="/estudiante"
                                    class="block px-4 py-2 text-sm hover:bg-plasma-line hover:text-cyber-cyan">Mi
                                    Panel</a>
                                <button (click)="logout()"
                                    class="w-full text-left px-4 py-2 text-sm hover:bg-plasma-line hover:text-critical-red">Cerrar
                                    Sesión</button>
                            </div>
                        </div>
                    </ng-container>

                    <ng-template #notAuthenticated>
                        <a routerLink="/auth/login"
                            class="inline-flex items-center justify-center px-4 py-1.5 border border-neon-violet text-sm font-medium rounded-md text-ghost-gray hover:bg-neon-violet transition-colors duration-200">
                            <fa-icon [icon]="faSignInAlt" class="mr-1"></fa-icon>
                            Acceder
                        </a>
                    </ng-template>
                </div>
            </div>

            <!-- Botón de menú móvil -->
            <div class="flex items-center md:hidden">
                <button type="button"
                    class="inline-flex items-center justify-center p-2 rounded-md text-ghost-gray hover:text-cyber-cyan"
                    (click)="toggleMenu()" aria-expanded="false">
                    <fa-icon [icon]="isMenuOpen ? faTimes : faBars" class="text-xl"></fa-icon>
                </button>
            </div>
        </div>
    </div>

    <!-- Menú móvil -->
    <div class="md:hidden" [ngClass]="{'block': isMenuOpen, 'hidden': !isMenuOpen}">
        <div class="fixed inset-0 bg-void-black bg-opacity-95 backdrop-blur-sm flex flex-col pt-16">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 flex flex-col items-center">
                <ng-container *ngFor="let item of menuItems">
                    <a [routerLink]="item.path" [routerLinkActiveOptions]="{exact: item.exact}"
                        routerLinkActive="text-cyber-cyan"
                        class="block px-3 py-4 text-base font-medium text-ghost-gray hover:text-neon-violet"
                        (click)="closeMenu()">
                        {{ item.label }}
                    </a>
                </ng-container>
            </div>

            <!-- Enlaces de autenticación móvil -->
            <div class="pt-4 pb-3 border-t border-plasma-line flex flex-col items-center">
                <ng-container *ngIf="isAuthenticated(); else notAuthenticatedMobile">
                    <div class="flex items-center px-5 mb-4">
                        <div class="ml-3">
                            <div class="text-base font-medium leading-none text-ghost-gray">{{ currentUser()?.nombre }}
                                {{ currentUser()?.apellido }}</div>
                            <div class="text-sm font-medium leading-none text-plasma-line mt-1">{{ currentUser()?.email
                                }}</div>
                        </div>
                    </div>
                    <div class="mt-3 px-2 space-y-1 w-full flex flex-col items-center">
                        <a routerLink="/estudiante"
                            class="block px-3 py-2 text-base font-medium text-ghost-gray hover:text-cyber-cyan"
                            (click)="closeMenu()">
                            Mi Panel
                        </a>
                        <button (click)="logout()"
                            class="block px-3 py-2 text-base font-medium text-ghost-gray hover:text-critical-red">
                            Cerrar Sesión
                        </button>
                    </div>
                </ng-container>

                <ng-template #notAuthenticatedMobile>
                    <a routerLink="/auth/login"
                        class="flex items-center justify-center px-6 py-3 mt-4 border border-neon-violet bg-transparent hover:bg-neon-violet text-ghost-gray rounded-md transition-colors duration-200 w-48"
                        (click)="closeMenu()">
                        <fa-icon [icon]="faSignInAlt" class="mr-2"></fa-icon>
                        Acceder
                    </a>
                </ng-template>
            </div>
        </div>
    </div>
</nav>